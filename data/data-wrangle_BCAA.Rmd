---
title: "BCAA_data"
author: "Martin Monkman"
date: "April 3, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Code to summarize the BC Assessment data



```{r}
library(dplyr)
library(readr)
library(stringr)
library(tidyr)


library(ggplot2)


```


read source file(s) 

```{r  message = FALSE}


#BCAA2017data_Kootenay <- read_csv("C:/@data/GitHub/housing-data-visualization-project/data/BCAA/BC Stats - Housing Policy Analysis Kootenay Columbia.csv")

BCAA2017data_all <- read_csv("C:/@data/GitHub/housing-data-visualization-project/data/BCAA/BC Stats - Housing Policy Analysis Kootenay Columbia.csv", 
                        col_types = cols(PID = "c"))
                                  

setwd("C:/@data/GitHub/housing-data-visualization-project/data/BCAA")

BCAA2017data_all <- read_csv("BC Stats - Housing Policy Analysis Kootenay Columbia.csv", 
                        col_types = cols(PID = "c"))



countKoot <- nrow(BCAA2017data_all)
countall <- countKoot


ls.str(BCAA2017data_all)


```


(merge all 7 regions into 1? might be best to wait until it is in the SQL database and run some wrangling on the server)


```{r}


BCAA2017data_newbit <- read_csv("BC Stats - Housing Policy Analysis Fraser Valley.csv", 
                        col_types = cols(PID = "c"))

countFV <- nrow(BCAA2017data_newbit)
countall <- countall + countFV
                                  
BCAA2017data_all <- rbind(BCAA2017data_all, BCAA2017data_newbit)
rm(BCAA2017data_newbit)


###

BCAA2017data_newbit <- read_csv("BC Stats - Housing Policy Analysis Greater Vancouver.csv", 
                        col_types = cols(PID = "c"))

countGV <- nrow(BCAA2017data_newbit)
countall <- countall + countGV

BCAA2017data_all <- rbind(BCAA2017data_all, BCAA2017data_newbit)
rm(BCAA2017data_newbit)

###

BCAA2017data_newbit <- read_csv("BC Stats - Housing Policy Analysis Northern BC.csv", 
                        col_types = cols(PID = "c"))

countNBC <- nrow(BCAA2017data_newbit)
countall <- countall + countNBC

BCAA2017data_all <- rbind(BCAA2017data_all, BCAA2017data_newbit)
rm(BCAA2017data_newbit)


### 

BCAA2017data_newbit <- read_csv("BC Stats - Housing Policy Analysis Thompson Okanagan.csv", 
                        col_types = cols(PID = "c"))
                                  
countTO <- nrow(BCAA2017data_newbit)
countall <- countall + countTO

BCAA2017data_all <- rbind(BCAA2017data_all, BCAA2017data_newbit)
rm(BCAA2017data_newbit)


### 

BCAA2017data_newbit <- read_csv("BC Stats - Housing Policy Analysis Vancouver Island.csv", 
                        col_types = cols(PID = "c"))
                                  
countVI <- nrow(BCAA2017data_newbit)
countall <- countall + countVI

BCAA2017data_all <- rbind(BCAA2017data_all, BCAA2017data_newbit)
rm(BCAA2017data_newbit)


write_csv(BCAA2017data_all, "BCAA2017data_all.csv")

```


## READ THE WHOLE FILE

```{r}

BCAA2017data_all <- read_csv("BCAA2017data_all.csv")

```



## GEOGRAPHY


read geography file

```{r  message = FALSE}

cadastre_da_2011 <- read_csv("C:/@data/GitHub/housing-data-visualization-project/data/geography/cadastre_da_2011.csv")

ls.str(cadastre_da_2011)

cadastre_da_2011_DAUID <- cadastre_da_2011 %>%
  select(PID, DAUID)

```



#### The Join


```{r}

BCAA2017data_all_geog <- BCAA2017data_all %>% 
  left_join(cadastre_da_2011_DAUID, by = "PID")

ls.str(BCAA2017data_all_geog)


```


